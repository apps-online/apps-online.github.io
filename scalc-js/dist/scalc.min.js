function scalc(options={}){var init=function(){var calculator=document.getElementById("calculator"),html='\n            <div id="window" tabindex="0">\n              <div id="topbar">\n                <a href="Close" tabindex="-1">X</a>\n              </div>\n              <div id="display"></div>\n              <ul>\n                <li><a href="Escape" tabindex="-1">C</a></li>\n                <li><a href="%" tabindex="-1">%</a></li>\n                <li><a href="/" tabindex="-1">/</a></li>\n                <li><a href="*" tabindex="-1">*</a></li>\n                <li><a href="7" tabindex="-1">7</a></li>\n                <li><a href="8" tabindex="-1">8</a></li>\n                <li><a href="9" tabindex="-1">9</a></li>\n                <li><a href="-" tabindex="-1">-</a></li>\n                <li><a href="4" tabindex="-1">4</a></li>\n                <li><a href="5" tabindex="-1">5</a></li>\n                <li><a href="6" tabindex="-1">6</a></li>\n                <li><a href="+" tabindex="-1">+</a></li>\n                <li><a href="1" tabindex="-1">1</a></li>\n                <li><a href="2" tabindex="-1">2</a></li>\n                <li><a href="3" tabindex="-1">3</a></li>\n                <li><a href="Enter" class="equal" tabindex="-1">=</a></li>\n                <li><a href="0" class="zero" tabindex="-1">0</a></li>\n                <li><a href="." class="dot" tabindex="-1">.</a></li>\n              </ul>\n            </div>',container,topbar;if(options.modal=!0===options.modal,options.draggable=!1!==options.draggable,!0===options.modal){calculator.innerHTML='<div id="container"><div id="draggable">'+html+"</div></div>";var _window=calculator.querySelector("#window"),width=(window.innerWidth-_window.offsetWidth)/2,height=(window.innerHeight-_window.offsetHeight)/2;calculator.querySelector("#draggable").style.left=width+"px",calculator.querySelector("#draggable").style.top=height+"px";var $draggable=(container=calculator.querySelector("#container"),topbar=calculator.querySelector("#topbar"),{resize:function(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||document.body.offsetWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||document.body.offsetHeight;container.style.width=e+"px",container.style.height=t+"px"},move:function(e,t,n){e.style.left=t+"px",e.style.top=n+"px"},startMoving:function(e,t){addClass(topbar,"cursor-move");var n=(t=t||window.event).clientX,i=t.clientY,o=e.style.top,a=e.style.left,l=parseInt(e.style.width),r=parseInt(e.style.height),s=parseInt(container.style.width),c=parseInt(container.style.height);o=o.replace("px","");var d=n-(a=a.replace("px","")),u=i-o;document.onmousemove=function(t){var n=(t=t||window.event).clientX,i=t.clientY,o=n-d,a=i-u;o<0&&(o=0),a<0&&(a=0),o+l>s&&(o=s-l),a+r>c&&(a=c-r),$draggable.move(e,o,a)}},stopMoving:function(){document.createElement("script"),removeClass(topbar,"cursor-move"),document.onmousemove=function(){}},init:function(){var e=calculator.querySelector("#draggable"),t=function(){var e=document.documentElement.scrollWidth,t=document.documentElement.scrollHeight;container.style.width=e+"px",container.style.height=t+"px"};$draggable.resize(),window.onresize=function(){$draggable.resize()},window.onscroll=function(){t()},topbar.onmousedown=function(n){var i=calculator.querySelector("#window");t(),e.style.width="480px",e.style.height=i.offsetHeight+"px",!0===options.draggable&&$draggable.startMoving(e)},document.onmouseup=function(){!0===options.draggable&&$draggable.stopMoving()}}});$draggable.init()}else{calculator.innerHTML=html;var _window=calculator.querySelector("#window"),width=(window.innerWidth-_window.offsetWidth)/2,height=(window.innerHeight-_window.offsetHeight)/2;_window.style.left=width+"px",_window.style.top=height+"px",!0===options.draggable&&function(e){var t=0,n=0,i=0,o=0,a=calculator.querySelector("#topbar");function l(a){(a=a||window.event).preventDefault();var l=window.innerWidth,r=window.innerHeight,s=e.offsetWidth,c=e.offsetHeight;t=i-a.clientX,n=o-a.clientY,i=a.clientX,o=a.clientY,e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px",e.offsetLeft-t>=l-s&&(e.style.left=l-s+"px"),e.offsetTop-n>=r-c&&(e.style.top=r-c+"px"),(e.offsetTop-n<=0||c>=r)&&(e.style.top="0"),(e.offsetLeft-t<=0||s>=l)&&(e.style.left="0")}function r(){removeClass(a,"cursor-move"),document.onmouseup=null,document.onmousemove=null}a.onmousedown=function(e){addClass(a,"cursor-move"),(e=e||window.event).preventDefault(),i=e.clientX,o=e.clientY,document.onmouseup=r,document.onmousemove=l}}(_window)}var css_class="button-pressed",hasClass=function(e,t){if(e.classList)return e.classList.contains(t);var n=new RegExp("(\\s|^)"+t+"(\\s|$)");return!!e.className.match(n)},addClass=function(e,t){e.classList?e.classList.add(t):hasClass(e,t)||(e.className+=" "+t)},removeClass=function(e,t){if(e.classList)e.classList.remove(t);else if(hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}},display=calculator.querySelector("#display"),memory="",reset=function(){memory="",display.innerHTML=""},insert=function(e){display.innerHTML+="/"===e?"&divide;":e,memory+=e},total=function(){memory=eval(memory)||0,display.innerHTML=memory||""},button=function(e){return calculator.querySelector('a[href="'+e+'"]')},load=new Event("load"),_window=calculator.querySelector("#window");_window.onload=function(e){this.focus()},_window.dispatchEvent(load),_window.onfocus=function(e){e.preventDefault(),removeClass(this,"disable")},_window.onblur=function(e){e.preventDefault(),addClass(this,"disable")};for(var tag=calculator.getElementsByTagName("a"),i=0;i<tag.length;i++)button(tag[i].getAttribute("href")).onclick=function(e){e.preventDefault();var t=this.getAttribute("href");"Enter"===t?total():"Escape"===t?reset():"Close"===t?calculator.innerHTML="":insert(t)},button(tag[i].getAttribute("href")).onmousedown=function(e){e.preventDefault(),addClass(this,css_class)},button(tag[i].getAttribute("href")).onmouseup=function(e){e.preventDefault(),removeClass(this,css_class)};calculator.querySelector("ul").onclick=function(e){e.preventDefault(),_window.focus()},calculator.querySelector("#topbar").onclick=function(e){e.preventDefault(),_window.focus()};var $key=function(e){return e.key?e.key:String.fromCharCode(e.which||e.keyCode)};_window.onkeypress=function(e){e.preventDefault();var t=$key(e).replace(/[^0-9\/\*\-\+\.\%]/g,"");t&&insert(t)},_window.onkeydown=function(e){var t=$key(e),n=button(t);n&&addClass(n,css_class),"Enter"===t?total():"Escape"===t&&reset()},_window.onkeyup=function(e){var t=$key(e),n=button(t);if(n&&removeClass(n,css_class),"Backspace"===t){var i=display.innerHTML;i=i.substr(0,i.length-1),display.innerHTML=i,memory=i}}};try{init()}catch(e){window.onload=function(){init()}}}
